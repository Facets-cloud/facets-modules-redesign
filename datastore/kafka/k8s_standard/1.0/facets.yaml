intent: kafka
flavor: k8s_standard
version: '1.0'
clouds:
- kubernetes
description: Apache Kafka cluster deployed using Strimzi Kafka Operator with KRaft
  mode
spec:
  title: Strimzi Kafka Cluster
  description: Apache Kafka cluster deployed using Strimzi Kafka Operator with KRaft
    mode (no ZooKeeper)
  type: object
  properties:
    kafka_version:
      type: string
      title: Kafka Version
      description: Apache Kafka version to deploy
      default: 4.0.0
      enum:
      - 4.0.0
      - 4.1.0
    replica_count:
      type: number
      title: Replica Count
      description: Number of Kafka broker replicas (dual-role controller+broker)
      default: 3
      minimum: 1
      maximum: 9
    resources:
      type: object
      title: Resources
      description: CPU and memory resources for Kafka pods
      properties:
        cpu:
          type: string
          title: CPU
          description: CPU request and limit (e.g., 1000m, 2)
          default: '1'
        memory:
          type: string
          title: Memory
          description: Memory request and limit (e.g., 2Gi, 4Gi)
          default: 2Gi
          pattern: ^[0-9]+[GM]i$
    storage_size:
      type: string
      title: Storage Size
      description: Persistent volume size per replica
      default: 10Gi
      pattern: ^[0-9]+[GM]i$
    listeners:
      type: object
      title: Listeners
      description: Kafka listener configuration
      properties:
        plain_enabled:
          type: boolean
          title: Plain Listener
          description: Enable plain (non-TLS) listener on port 9092
          default: true
        tls_enabled:
          type: boolean
          title: TLS Listener
          description: Enable TLS listener on port 9093
          default: true
    config:
      type: object
      title: Kafka Configuration
      description: Kafka broker configuration
      properties:
        offsets_topic_replication_factor:
          type: number
          title: Offsets Topic Replication Factor
          default: 3
        transaction_state_log_replication_factor:
          type: number
          title: Transaction State Log Replication Factor
          default: 3
        transaction_state_log_min_isr:
          type: number
          title: Transaction State Log Min ISR
          default: 2
        default_replication_factor:
          type: number
          title: Default Replication Factor
          default: 3
        min_insync_replicas:
          type: number
          title: Min In-Sync Replicas
          default: 2
  required:
  - kafka_version
  - replica_count
inputs:
  kubernetes_cluster:
    type: '@facets/kubernetes-details'
    optional: false
    displayName: Kubernetes Cluster
    description: Target Kubernetes cluster for Kafka deployment
    providers:
    - kubernetes
    - helm
  node_pool:
    type: '@facets/kubernetes_nodepool'
    optional: false
    displayName: Node Pool
    description: Node pool for Kafka pods
  strimzi_operator:
    type: '@facets/helm'
    optional: false
    displayName: Strimzi Kafka Operator
    description: Strimzi Kafka Operator Helm release
outputs:
  default:
    type: '@facets/kafka'
    title: Kafka Cluster
iac:
  validated_files:
  - main.tf
  - variables.tf
  - locals.tf
sample:
  kind: kafka
  flavor: strimzi-kafka
  version: '1.0'
  disabled: false
  spec:
    kafka_version: 4.0.0
    replica_count: 3
    storage_size: 10Gi
