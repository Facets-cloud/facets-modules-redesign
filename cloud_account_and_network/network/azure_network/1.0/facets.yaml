intent: network
flavor: azure-network
version: '1.0'
description: Creates an Azure Virtual Network with automatically calculated subnet
  sizes from a /16 CIDR range, with one public and one private subnet per availability
  zone
clouds:
- azure
inputs:
  cloud_account:
    type: '@facets/azure_cloud_account'
    displayName: Cloud Account
    description: The Azure Cloud Account where the AKS cluster will be created
    optional: false
    providers:
    - azurerm
spec:
  type: object
  properties:
    vnet_cidr:
      type: string
      title: VNet CIDR Block (/16 only)
      description: CIDR block for the Virtual Network (must be a /16 block, e.g.,
        10.0.0.0/16)
      pattern: ^([0-9]{1,3}\.){3}[0-9]{1,3}/16$
      x-ui-overrides-only: true
      x-ui-error-message: CIDR must be a valid /16 IP block (e.g., 10.0.0.0/16)
      x-ui-placeholder: 10.0.0.0/16
    region:
      type: string
      title: Azure Region
      description: Azure region where the VNet will be created
    availability_zones:
      type: array
      title: Availability Zones
      description: List of availability zones to use for subnets (e.g., ["1", "2",
        "3"])
      items:
        type: string
      minItems: 1
      maxItems: 3
      x-ui-override-disable: true
    nat_gateway:
      type: object
      title: NAT Gateway Configuration
      properties:
        strategy:
          type: string
          title: NAT Gateway Strategy
          description: Choose whether to create one NAT Gateway or one per availability
            zone
          enum:
          - single
          - per_az
          default: single
      required:
      - strategy
    tags:
      type: object
      title: Additional Tags
      description: Optional additional tags to apply to all VNet resources. These
        will be merged with the standard environment tags.
      x-ui-yaml-editor: true
  required:
  - vnet_cidr
  - region
  - availability_zones
  - nat_gateway
outputs:
  default:
    type: '@facets/azure-network-details'
sample:
  kind: network
  flavor: azure-network
  version: '1.0'
  spec:
    vnet_cidr: 10.0.0.0/16
    region: centralindia
    availability_zones:
    - '1'
    - '2'
    - '3'
    nat_gateway:
      strategy: single
    tags:
      Environment: production
      Project: main-infrastructure
iac:
  validated_files:
  - main.tf
  - variables.tf
  - locals.tf
  - network.tf
  - subnets.tf
  - nat-gateway.tf
  - routing.tf
  - security-groups.tf
  - outputs.tf
