intent: kubernetes_node_pool
flavor: azure
version: '1.0'
description: Custom Azure Kubernetes Service node pool module
intentDetails:
  type: Cloud & Infrastructure
  description: Azure AKS node pool with auto-scaling and customizable VM sizes
  displayName: Kubernetes Node Pool
  iconUrl: https://raw.githubusercontent.com/Facets-cloud/facets-modules-redesign/main/icons/kubernetes_node_pool.svg
clouds:
- azure
inputs:
  kubernetes_details:
    type: '@facets/azure_aks'
    displayName: AKS Cluster
    description: The AKS cluster where the node pool will be created
    optional: false
    providers:
    - helm
    - kubernetes
    - kubernetes-alpha
  cloud_account:
    type: '@facets/azure_cloud_account'
    displayName: Cloud Account
    description: The Azure Cloud Account where the AKS cluster will be created
    optional: false
    providers:
    - azurerm
outputs:
  attributes:
    type: '@facets/azure_aks_nodepool'
    title: AKS NodePool
  default:
    type: '@facets/kubernetes_nodepool'
    title: Kubernetes Nodepool
spec:
  title: Kubernetes Node Pool
  description: Specification of the kubernetes node pool for aks flavor
  type: object
  properties:
    instance_type:
      title: Instance Type
      description: SKU of the virtual machines used in this node pool
      type: string
      x-ui-placeholder: Eg. Standard_D4a_v4
    min_node_count:
      title: Min Node Count
      description: Minimum number of nodes which should exist within this node pool
      type: integer
      minimum: 0
      maximum: 100
    max_node_count:
      title: Max Node Count
      description: Maximum number of nodes which should exist within this node pool
      type: integer
      minimum: 0
      maximum: 100
    disk_size:
      title: Disk Size
      description: Size of the Disk in GiB for node in this node pool
      type: string
      pattern: \b((5[0-9]G)|([6-9][0-9]G)|([1-9][0-9][0-9]G)|(1000G))\b
      x-ui-placeholder: eg. 50G
      x-ui-error-message: Value doesn't match the format eg. 50G. Minimum is 50G and
        max is 1000G
    taints:
      title: Taints
      description: Map of Kubernetes taints which should be applied to nodes in the
        node pool
      type: object
      patternProperties:
        ^[a-z][a-z0-9-_]*$:
          type: object
          title: Taint Object
          properties:
            key:
              title: Taint Key
              description: Taint Key
              type: string
              x-ui-placeholder: CriticalAddonsOnly
            value:
              title: Taint Value
              description: Taint Value
              type: string
              x-ui-placeholder: 'true'
            effect:
              title: Taint Effect
              description: Taint Effect
              type: string
              x-ui-placeholder: NoSchedule
    labels:
      title: Labels
      description: Map of labels to be added to nodes in node pool. Enter key-value
        pair for labels in YAML format. Eg. key:value (provide a space after colon
        as expected in the YAML format)
      x-ui-placeholder: 'Eg. key1: value1'
      type: object
      x-ui-yaml-editor: true
  required:
  - instance_type
  - min_node_count
  - max_node_count
  - disk_size
  - taints
iac:
  validated_files:
  - main.tf
  - variables.tf
  - outputs.tf
sample:
  flavor: azure
  kind: kubernetes_node_pool
  disabled: true
  version: '1.0'
  spec:
    instance_type: Standard_F8
    min_node_count: 0
    max_node_count: 100
    disk_size: 50G
    taints: {}
    labels: {}
