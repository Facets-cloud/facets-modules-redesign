clouds:
  - aws
description: |
  Deploys the AWS EFS CSI Driver on EKS clusters via Helm.
  Creates an EFS file system, mount targets in each private subnet, and a security group
  allowing NFS traffic from the VPC. Configures IRSA (IAM Roles for Service Accounts)
  for the CSI controller and installs a StorageClass backed by EFS Access Points.
intentDetails:
  type: Cloud & Infrastructure
  description: AWS EFS CSI Driver for elastic file system storage on EKS
  displayName: AWS EFS CSI Driver
  iconUrl: https://raw.githubusercontent.com/Facets-cloud/facets-modules-redesign/main/icons/aws_efs_csi_driver.svg
flavor: standard
inputs:
  cloud_account:
    description: The AWS Cloud Account for IAM and resource provisioning
    displayName: Cloud Account
    optional: false
    providers:
      - aws
    type: '@facets/aws_cloud_account'
  kubernetes_details:
    description: The EKS cluster where the EFS CSI Driver will be deployed
    displayName: EKS Cluster
    optional: false
    providers:
      - helm
      - kubernetes
    type: '@facets/eks'
  network_details:
    default:
      resource_name: default
      resource_type: network
    displayName: Network
    type: '@facets/aws-vpc-details'
intent: aws_efs_csi_driver
outputs:
  default:
    title: AWS EFS CSI Driver Details
    type: '@facets/aws-efs-csi-driver'
sample:
  disabled: false
  flavor: standard
  kind: aws_efs_csi_driver
  spec:
    chart_version: "2.4.6"
    aws_efs_file_system: {}
    size: {}
  version: "1.0"
spec:
  description: Configure the AWS EFS CSI Driver for your EKS cluster
  properties:
    chart_version:
      default: "2.4.6"
      description: Helm chart version of the AWS EFS CSI Driver
      title: Chart Version
      type: string
    size:
      description: Resource requests for controller and node components
      title: Component Sizing
      type: object
      properties:
        controller:
          type: object
          description: Resource requests for the EFS CSI controller
          properties:
            cpu:
              type: string
              default: "100m"
              description: CPU request for the controller pod
            memory:
              type: string
              default: "128Mi"
              description: Memory request for the controller pod
        node:
          type: object
          description: Resource requests for the EFS CSI node DaemonSet
          properties:
            cpu:
              type: string
              default: "100m"
              description: CPU request for the node pod
            memory:
              type: string
              default: "128Mi"
              description: Memory request for the node pod
    aws_efs_file_system:
      description: Advanced configuration for the AWS EFS file system resource
      title: EFS File System Configuration
      type: object
      properties:
        encrypted:
          type: boolean
          default: true
          description: Enable encryption at rest for the EFS file system
          title: Encrypted
        kms_key_id:
          type: string
          description: ARN of the KMS key to use for encryption (uses AWS-managed key if omitted)
          title: KMS Key ID
        performance_mode:
          type: string
          description: EFS performance mode
          title: Performance Mode
        creation_token:
          type: string
          description: Unique token to ensure idempotent creation of the file system
          title: Creation Token
        availability_zone_name:
          type: string
          description: AWS Availability Zone for a One Zone EFS file system
          title: Availability Zone
        throughput_mode:
          type: string
          description: EFS throughput mode
          title: Throughput Mode
          enum:
            - bursting
            - provisioned
            - elastic
        provisioned_throughput_in_mibps:
          type: number
          description: Provisioned throughput in MiB/s (required when throughput_mode is provisioned)
          title: Provisioned Throughput (MiB/s)
        lifecycle_policy:
          type: object
          description: Lifecycle policy rules for transitioning files to/from Infrequent Access storage
          title: Lifecycle Policy
          x-ui-yaml-editor: true
        tags:
          type: object
          description: Additional AWS tags to apply to the EFS file system
          title: EFS Tags
          x-ui-yaml-editor: true
    tags:
      description: Additional AWS tags to apply to all EFS CSI Driver resources
      title: Resource Tags
      type: object
      x-ui-yaml-editor: true
  required:
    - chart_version
  title: AWS EFS CSI Driver Configuration
  type: object
  x-ui-order:
    - chart_version
    - size
    - aws_efs_file_system
    - tags
version: "1.0"
