clouds:
    - azure
description: Creates an Azure Virtual Network with automatically calculated subnet sizes, including dedicated database subnets with proper delegation for PostgreSQL and MySQL Flexible Servers
flavor: azure_network
iac:
    validated_files:
        - variables.tf
        - locals.tf
        - network.tf
        - subnets.tf
        - database-subnets.tf
        - dns-zones.tf
        - nat-gateway.tf
        - routing.tf
        - security-groups.tf
        - outputs.tf
inputs:
    cloud_account:
        description: The Azure Cloud Account where the network resources will be created
        displayName: Cloud Account
        optional: false
        providers:
            - azurerm
        type: '@facets/azure_cloud_account'
intent: network
outputs:
    default:
        title: Azure Network Details with Database Networking
        type: '@facets/azure-network-details'
sample:
    flavor: azure_network
    kind: network
    spec:
        availability_zones:
            - "1"
            - "2"
            - "3"
        database_config:
            enable_general_database_subnet: false
            enable_mysql_flexible_subnet: false
            enable_postgresql_flexible_subnet: false
        nat_gateway:
            strategy: single
        region: centralindia
        vnet_cidr: 10.0.0.0/16
    version: "1.0"
spec:
    properties:
        availability_zones:
            description: List of availability zones to use for subnets (e.g., ["1", "2", "3"])
            items:
                type: string
            maxItems: 3
            minItems: 1
            title: Availability Zones
            type: array
            x-ui-override-disable: true
        database_config:
            description: Configuration for database-related subnets (automatically allocates /24 blocks)
            properties:
                enable_general_database_subnet:
                    default: false
                    description: Creates a /24 subnet for private endpoints and non-delegated database resources
                    title: Enable General Database Subnet
                    type: boolean
                enable_mysql_flexible_subnet:
                    default: false
                    description: Creates a /24 delegated subnet for MySQL Flexible Servers
                    title: Enable MySQL Flexible Server Subnet
                    type: boolean
                enable_postgresql_flexible_subnet:
                    default: false
                    description: Creates a /24 delegated subnet for PostgreSQL Flexible Servers
                    title: Enable PostgreSQL Flexible Server Subnet
                    type: boolean
            title: Database Subnet Configuration
            type: object
        nat_gateway:
            properties:
                strategy:
                    default: single
                    description: Choose whether to create one NAT Gateway or one per availability zone
                    enum:
                        - single
                        - per_az
                    title: NAT Gateway Strategy
                    type: string
            required:
                - strategy
            title: NAT Gateway Configuration
            type: object
        region:
            description: Azure region where the VNet will be created
            title: Azure Region
            type: string
        tags:
            description: Optional additional tags to apply to all VNet resources
            title: Additional Tags
            type: object
            x-ui-yaml-editor: true
        vnet_cidr:
            description: CIDR block for the Virtual Network (must be a /16 block, e.g., 10.0.0.0/16)
            pattern: ^([0-9]{1,3}\.){3}[0-9]{1,3}/16$
            title: VNet CIDR Block (/16 only)
            type: string
            x-ui-error-message: CIDR must be a valid /16 IP block (e.g., 10.0.0.0/16)
            x-ui-overrides-only: true
            x-ui-placeholder: 10.0.0.0/16
    required:
        - vnet_cidr
        - region
        - availability_zones
        - nat_gateway
    type: object
version: "1.0"
