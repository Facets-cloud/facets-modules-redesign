intent: artifactories
flavor: standard
version: '1.0'
description: Adds artifactories - default flavor
clouds:
- gcp
- kubernetes
- azure
- aws
inputs:
  kubernetes_details:
    optional: false
    type: '@facets/kubernetes-details'
    displayName: Kubernetes Cluster
    default:
      resource_type: kubernetes_cluster
      resource_name: default
    providers:
    - kubernetes
    - kubernetes-alpha
    - helm
  kubernetes_node_pool_details:
    type: '@facets/kubernetes_nodepool'
    displayName: Node Pool
    optional: true
    default:
      resource_type: kubernetes_node_pool
      resource_name: general-purpose
spec:
  title: Artifactories
  type: object
  description: Specification of the Artifactories resource intent
  properties:
    include_all:
      type: boolean
      title: Include All
      description: Include all container registries mapped to this project.
    artifactories:
      title: Artifactories
      type: object
      description: A map of Container Registries.
      x-ui-visible-if:
        field: spec.include_all
        values:
        - false
      patternProperties:
        ^[a-zA-Z0-9_.-]*$:
          title: Artifactories Object Block
          description: The Name of the Container Registry for creating a secret.
          type: object
          properties:
            name:
              title: Name
              type: string
              description: Container Registry Name
              x-ui-api-source:
                endpoint: /cc-ui/v1/artifactories
                method: GET
                params:
                  includeContent: false
                labelKey: name
                valueKey: name
    artifactory_credentials:
      title: Artifactory Credentials
      type: array
      description: Credentials for container registries (provided by control plane)
      x-ui-skip: true
      items:
        type: object
        required:
          - name
          - uri
          - artifactoryType
        properties:
          name:
            type: string
            description: Artifactory identifier
          uri:
            type: string
            description: Registry URI
          artifactoryType:
            type: string
            title: Registry Type
            description: Type of container registry
            enum: [ECR, DockerHub, GCR, ACR]
          awsKey:
            type: string
            title: AWS Access Key
            description: AWS access key (ECR only)
            x-ui-visible-if:
              field: artifactoryType
              values: [ECR]
          awsSecret:
            type: string
            title: AWS Secret Key
            description: AWS secret key (ECR only)
            x-ui-visible-if:
              field: artifactoryType
              values: [ECR]
          awsAccountId:
            type: string
            title: AWS Account ID
            description: AWS account ID (ECR only)
            x-ui-visible-if:
              field: artifactoryType
              values: [ECR]
          awsRegion:
            type: string
            title: AWS Region
            description: AWS region (ECR only)
            x-ui-visible-if:
              field: artifactoryType
              values: [ECR]
          username:
            type: string
            title: Username
            description: Registry username (DockerHub/GCR/ACR)
            x-ui-visible-if:
              field: artifactoryType
              values: [DockerHub, GCR, ACR]
          password:
            type: string
            title: Password
            description: Registry password (DockerHub/GCR/ACR)
            x-ui-visible-if:
              field: artifactoryType
              values: [DockerHub, GCR, ACR]
          email:
            type: string
            title: Email
            description: Registry email (DockerHub/GCR/ACR)
            x-ui-visible-if:
              field: artifactoryType
              values: [DockerHub, GCR, ACR]
outputs:
  default:
    type: '@facets/artifactories'
    title: Artifactories Details
sample:
  version: '1.0'
  flavor: standard
  kind: artifactories
  disabled: true
  spec:
    include_all: false
